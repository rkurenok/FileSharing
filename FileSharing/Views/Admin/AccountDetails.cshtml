@model FileSharing.Models.PageViewModel
@using FileSharing.Helpers

@{
    ViewBag.Title = "AccountDetails";
    string text = "Если файл имеет тип доступа \"Закрытый\", то доступ к этому файлу имеете только вы в своем профиле, а если файл имеет тип доступа \"Открытый\", то доступ к нему имеют все пользователи во вкладке \"Файлы\"";
}

@if (ViewBag.StatusMessage != "")
{
    <div class="text-event-success container-fluid">@ViewBag.StatusMessage</div>
}
<br />
<h2 id="headerId" class="container">Профиль пользователя</h2>
<br />
<br />

<div style="margin:0 auto;">
    <div id="accountDetailsAdmin" class="text-center" style=" margin: auto;">
        <br />
        <div>
            <dl class="row">
                <dt class="col-md-6">
                    Email
                </dt>

                <dd class="col-md-6">
                    @ViewBag.User.Email
                </dd>
            </dl>
            <dl class="row">
                <dt class="col-md-6">
                    Логин
                </dt>

                <dd class="col-md-6">
                    @ViewBag.User.Login
                </dd>
            </dl>
            <dl class="row">
                <dt class="col-md-6">
                    Возраст
                </dt>

                <dd class="col-md-6">
                    @ViewBag.User.Age
                </dd>
            </dl>
            <dl class="row">
                <dt class="col-md-6">
                    Пол
                </dt>

                <dd class="col-md-6">
                    @ViewBag.User.Gender
                </dd>
            </dl>
            <dl class="row">
                <dt class="col-md-6">
                    Роль
                </dt>
                <dd class="col-md-6">
                    @if (@ViewBag.User.RoleId == 2)
                    {
                        <p>User</p>
                    }
                    else
                    {
                        <p>Admin</p>
                    }
                </dd>
            </dl>
            <dl class="row">
                <dt class="col-md-6">
                    @Html.ActionLink("Изменить роль", "EditUserRole", new { userId = ViewBag.User.Id }, htmlAttributes: new { @class = "btn btn-primary", @style = "min-width: 219px" })
                </dt>
                <dt class="col-md-6">
                    @Html.ActionLink("Назад", "Index", "Admin", null, htmlAttributes: new { @class = "btn btn-warning", @style = "min-width: 219px" })
                </dt>
            </dl>
        </div>
    </div>
</div>

<br />
<h2 id="headerId" class="container">Файлы пользователя</h2>
<br />
<br />

<div class="row" style="">
    @foreach (var item in Model.Files)
    {
        <div class="col-md-3">
            <div class="thumbnail pull-left">
                <div style="margin:0 auto;">
                    <div id="fileIndex" class="text-center" style=" margin: auto;">
                        <br />
                        @Html.ActionLink(item.Name, "Details", "File", new { id = item.Id }, htmlAttributes: new { @style = "font-size: 19px; color: #78c0ff;" })
                        <br />
                        <br />

                        @{string size = string.Format("{0} Б", item.SizeInBytes);
                            double sizeInKBytes, sizeInMBytes, sizeInGBytes;
                            if (item.SizeInBytes >= 1024)
                            {
                                sizeInKBytes = (double)item.SizeInBytes / 1024;
                                size = string.Format("{0:N2} КБ", sizeInKBytes);
                                if (sizeInKBytes >= 1024)
                                {
                                    sizeInMBytes = (double)sizeInKBytes / 1024;
                                    size = string.Format("{0:N2} МБ", sizeInMBytes);
                                    if (sizeInMBytes >= 1024)
                                    {
                                        sizeInGBytes = (double)sizeInMBytes / 1024;
                                        size = string.Format("{0:N2} ГБ", sizeInGBytes);
                                    }
                                }
                            }
                        }
                        <div>@size</div>
                        @Html.DisplayFor(modelItem => item.Date)
                        <br />
                        @(item.AccessId == 1 ? "Закрытый" : "Открытый")
                        <span id="btn-tooltip" style="font-size: 100%" class="glyphicon glyphicon-question-sign btn-secondary" data-toggle="tooltip" data-placement="right" title="@text"></span>
                        <div class="row">
                            <br />
                        </div>
                        <div class="row">
                            <br />
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                @Html.ActionLink("Скачать", "Download", new { fileId = item.Id }, htmlAttributes: new { @class = "btn btn-success", @style = "background-color: #5cb85cbf" })
                            </div>
                            <div class="col-md-4">
                            </div>
                            <div class="col-md-4">
                                @Html.ActionLink("Удалить", "Delete", "File", new { fileId = item.Id }, htmlAttributes: new { @class = "btn btn-danger", @style = "viewDiv()" })
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    }
</div>

<div class="container-fluid text-center">
    <div class="row">
        <div class="btn-group btn-group-lg">
            @Html.PageLinks(Model.PageInfo, x => Url.Action("Index", new { page = x, category = ViewBag.CategoryId }))
        </div>
    </div>
</div>
<br />
